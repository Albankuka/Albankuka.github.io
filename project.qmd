---
title: DANL Project
subtitle: "Data-Driven Mastery: Unlocking Business Potential"
author: 
  - Alban Kuka
  - Henry Socash
  - Victoria Pavlock
  - Jeremy Sun
  - Jackson Boyer 

toc: true
toc-title: "Table of Contents"
toc-depth: 2
number-sections: true

fig-width: 9

execute:
  code-tools: true
  message: false
  warning: false

from: markdown+emoji
---
```{r setup}
#| include: false
library(tidyverse)
library(skimr)
library(ggthemes)
library(hrbrthemes)
earthquake <- read.csv('/Users/alban/Downloads/earthquake data.csv')
theme_set(theme_ipsum()+
          theme(strip.background =element_rect(fill="lightgray"),
                axis.title.x = 
                  element_text(angle = 0,
                               size = rel(1.33),
                               margin = margin(10,0,0,0)),
                axis.title.y = 
                  element_text(angle = 0,
                               size = rel(1.33),
                               margin = margin(0,10,0,0))
                )
          )
```



# Introduction

About this project :clap: - My teammates and I will be observing worldwide earthquake occurrences data that took place in 2023. Analyzing this data will allow us to determine how Depth varies by Magnitude and how factors such as Location and time affect the destructiveness of these earthquakes.

```{r}
earthquake <- read.csv('/Users/alban/Downloads/earthquake data.csv')
```

## Significance

Analyzing this data will help us determine the countries across the world that encounter the most devastating earthquakes. This can help and raise awareness for natural disasters in these countries and contribute to safety protocols for when earthquakes occur. The more we can prove a country is suffering because of natural disasters the more we can advocate for advanced infrastructure designed for safety during these occurrences. 


## The Author: Syed Anwar

The author of this earthquake data is Syed Anwar, titled:  "Earthquake Events Worldwide 2023" Syed explains the parameters of his data by saying, “With a total of 53,540 data points, this dataset offers a valuable resource for researchers, geologists, and data enthusiasts to explore and analyze seismic trends, patterns, and distributions across the globe.” 


## Data

In the data `earthquake` that we have sourced from Kaggle, which can be found at: [https://www.kaggle.com/datasets/syedanwarafridi/earthquake-events-worldwide-2023?rvi=1](https://www.kaggle.com/datasets/syedanwarafridi/earthquake-events-worldwide-2023?rvi=1). The description states “a comprehensive catalog capturing seismic activity from January 1, 2023, to December 31, 2023. This dataset provides a detailed record of earthquakes globally, including crucial information such as date and time, geographic coordinates, depth, magnitude, and the affected region’s land type and country.” We have many variables to consider which allows us to obtain detailed information on specific earthquakes and their frequency. 

```{r}
earthquake <- read.csv('/Users/alban/Downloads/earthquake data.csv')
```

```{r}
#| results: asis
#| echo: false
rmarkdown::paged_table(earthquake)
```

# Summary Statistics

Using the skim function we can get simple summary statistics for the variables: `Magnitude` and `Depth` The information such as mean and standard deviation would be for the worldwide data.

```{r}
earthquake1 <- earthquake %>% select(Magnitude,Depth)
skim(earthquake1)
```

```{r}
#| results: asis
#| echo: false
rmarkdown::paged_table(earthquake) 
```


## Magnitude Statistics

For a more detailed summary for `Magnitude` I transformed the data to return all summary statistics for only magnitude. This will allow us to see worldwide averages of the severity of earthquakes. 

```{r}
summagnitude <- earthquake %>% 
  summarize(
    mean_magnitude = mean(Magnitude, na.rm = T), 
    sd_magnitude = sd(Magnitude),
    q1_magnitude = quantile(Magnitude, probs = .25, na.rm = T),
    median_magnitude = median(Magnitude),
    q3_magnitude = quantile(Magnitude, probs = .75, na.rm =  T),
    min_magnitude = min(Magnitude, na.rm = T),
    max_magnitude = max(Magnitude, na.rm = T)
  )

```

```{r}
#| results: asis
#| echo: false
rmarkdown::paged_table(summagnitude) 
```


## Frequency Data 
The following freqpoly and histograms show how the frequency/occurrences of (`Magnitude`) varies by the (`Depth`) of the earthquake. We can determine the correlation between these two variables to find relationships on the strengths of earthquakes.

```{r}
ggplot(earthquake, aes(x = Magnitude)) +
  geom_freqpoly(bins = 100)
```

From this freqpoly we can see that the level 2 magnitude earthquakes seem to be the most common with almost 4000 occurrences worldwide. the density of this plot shows us that between level 2 and 6, majority of earthquakes rumble at these magnitudes.


```{r}
ggplot(earthquake, aes(x = log(Depth))) +
  geom_histogram(bins = 50)
```

From this histogram we can see that the depth of around 2.3 kilometers was the depth that occurred the most with a frequency of 8000 so mainly earthquakes in general have a depth of 1.7 to 2.3 kilometers.


```{r}
ggplot(earthquake) +
  geom_bar(aes(y = Magnitude, 
               x = stat(prop), group = 1)) 
```

Since we are viewing the proportions of magnitude in this visualization we can note that 6% of our data is from a level 2 magnitude earthquake measured on the richter scale, 4% of the data relates to extremely high or low levels of magnitude.


# Location 

This section of the project focuses on the location of these earthquakes and where in the world these earthquakes happen the most. The location is based on the variables `Country` and `Lands` for the year of 2023.

## Top 10

What are the top ten countries that encounter the most earthquakes in 2023? 

```{r}
quaked <- earthquake %>% 
  group_by(Country , Lands) %>% 
  summarize(count =n()) %>% 
  arrange(desc(count)) %>% 
  filter(row_number() <=10) %>% 
  head(quaked, n = 10)
```

```{r}
#| results: asis
#| echo: false
rmarkdown::paged_table(quaked)
```









